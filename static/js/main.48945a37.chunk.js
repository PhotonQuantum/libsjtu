(this.webpackJsonplibsjtu=this.webpackJsonplibsjtu||[]).push([[0],{51:function(e,t,n){e.exports=n(79)},56:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),i=n.n(o),c=(n(56),n(15)),l=n.n(c),u=n(23),s=n(17),f=n(103),m=n(101),d={green:["#4caf50","#e8f5e9"],blue:["#2196f3","#e3f2fd"],yellow:["#ff9800","#fff3e0"],red:["#f44336","#fbe9e7"],default:["#eceff1","#607d8b"]},p=function(e){var t=e.name,n=e.rest,a=e.max,o=n/a*100,i=Object(m.a)((function(){return function(e){var t="",n=d[t=e>=75?"green":e>=50?"blue":e>=25?"yellow":e<25?"red":"default"][0];return{colorPrimary:{backgroundColor:d[t][1]},barColorPrimary:{backgroundColor:n}}}(o)}));return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",marginLeft:"10px",marginRight:"10px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",marginBottom:"10px"}},r.a.createElement("div",{style:{marginRight:"auto"}},t),r.a.createElement("div",{style:{marginLeft:"auto"}},r.a.createElement("b",null,n),"/",a)),r.a.createElement(f.a,{variant:"determinate",value:o,classes:i()}))},v=n(104),g=n(105),h=function(e){var t=e.title,n=e.data&&e.data.length>0?e.data.sort((function(e,t){return 0===e.max?1:0===t.max?-1:t.rest/t.max-e.rest/e.max})):[];return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"}},r.a.createElement("h2",{style:{marginLeft:"auto",marginRight:"auto"}},t),r.a.createElement(v.a,{container:!0,spacing:4,direction:"column"},e.loading&&r.a.createElement(g.a,{style:{alignSelf:"center",marginTop:"30px",marginBottom:"30px"}}),n.map((function(e){return r.a.createElement(v.a,{item:!0,key:e.name},r.a.createElement(p,{name:e.name,rest:e.rest,max:e.max,key:e.name}))}))))},b=n(106),w=n(109),y=n(108),E=n(30),j=n.n(E),x=function(){var e=Object(u.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j.a.get("https://libsjtu.seanchao.workers.dev/").then((function(e){if(200===e.status){var a=e.data.match(/CountPerson\((.*)\)/),r=(a.length>1?JSON.parse(a[1]).numbers:[]).map((function(e){return{name:e.areaName,rest:e.max-e.inCounter,max:e.max}}));t&&t(r)}else n&&n()})).catch((function(){return n&&n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O=function(){var e=Object(u.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j.a.get("https://canteen.sjtu.edu.cn/CARD/Ajax/Place").then((function(e){if(200===e.status){var a=e.data.map((function(e){return{name:e.Name,rest:e.Seat_s-e.Seat_u,max:e.Seat_s}}));t&&t(a)}else n&&n()})).catch((function(){return n&&n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)([]),c=Object(s.a)(i,2),f=c[0],m=c[1],d=Object(a.useState)(!1),p=Object(s.a)(d,2),g=p[0],E=p[1],j=Object(a.useState)(""),k=Object(s.a)(j,2),S=k[0],C=k[1],A=Object(a.useState)(!0),W=Object(s.a)(A,2),R=W[0],N=W[1],P=Object(a.useState)(!0),D=Object(s.a)(P,2),L=D[0],B=D[1],T=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e){E(!0),C(e)},O((function(e){o(e),B(!1)}),(function(){t("\ud83d\ude25 \u83b7\u53d6\u98df\u5802\u6570\u636e\u5931\u8d25")})),x((function(e){m(e),N(!1)}),(function(){t("\ud83d\ude2b \u83b7\u53d6\u56fe\u4e66\u9986\u6570\u636e\u5931\u8d25")}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){T()}),[S]),Object(a.useEffect)((function(){var e=setInterval((function(){return T()}),2e4);return function(){return clearInterval(e)}}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null,r.a.createElement(v.a,{container:!0,justify:"center",direction:"column",spacing:2},r.a.createElement(v.a,{item:!0,style:{marginTop:"20px"}},r.a.createElement(h,{title:"\ud83d\udcd6",data:f,loading:R})),r.a.createElement(v.a,{item:!0},r.a.createElement(h,{title:"\ud83c\udf74",data:n,loading:L}))),r.a.createElement(w.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:g,autoHideDuration:2e3,onClose:function(){return E(!1),void C("")}},r.a.createElement(y.a,{severity:"error"},S))))};var S=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(k,null))},C=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function A(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!==n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/libsjtu",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/libsjtu","/service-worker.js");C?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!==a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):A(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):A(t,e)}))}}()}},[[51,1,2]]]);
//# sourceMappingURL=main.48945a37.chunk.js.map