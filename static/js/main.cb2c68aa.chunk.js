(this.webpackJsonplibsjtu=this.webpackJsonplibsjtu||[]).push([[0],{51:function(e,t,n){e.exports=n(79)},56:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),c=n.n(o),i=(n(56),n(15)),u=n.n(i),l=n(22),s=n(26),f=n(103),m=n(101),d={green:["#4caf50","#e8f5e9"],blue:["#2196f3","#e3f2fd"],yellow:["#ff9800","#fff3e0"],red:["#f44336","#fbe9e7"],default:["#90caf9","#a6d4fa"]},v=function(e){var t=e.name,n=e.rest,a=e.max,o=n/a*100,c=Object(m.a)((function(){return function(e){var t="",n=d[t=e>=75?"green":e>=50?"blue":e>=25?"yellow":e>=0?"red":"default"][0];return{colorPrimary:{backgroundColor:d[t][1]},barColorPrimary:{backgroundColor:n}}}(o)}));return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",marginLeft:"10px",marginRight:"10px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",marginBottom:"10px"}},r.a.createElement("div",{style:{marginRight:"auto"}},t),r.a.createElement("div",{style:{marginLeft:"auto"}},r.a.createElement("b",null,n),"/",a)),r.a.createElement(f.a,{variant:"determinate",value:o,classes:c()}))},h=n(104),p=function(e){var t=e.title,n=e.data&&e.data.length>0?e.data.filter((function(e){return e.max>0})).sort((function(e,t){return t.rest/t.max-e.rest/e.max})):[];return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,t),r.a.createElement(h.a,{container:!0,spacing:4,direction:"column"},n.map((function(e){return r.a.createElement(h.a,{item:!0,key:e.name},r.a.createElement(v,{name:e.name,rest:e.rest,max:e.max,key:e.name}))}))))},g=n(105),b=n(108),w=n(107),E=n(30),j=n.n(E),y=function(){var e=Object(l.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j.a.get("https://libsjtu.seanchao.workers.dev/").then((function(e){if(200===e.status){var a=e.data.match(/CountPerson\((.*)\)/),r=a.length>1?JSON.parse(a[1]).numbers:[];t&&t(r)}else n&&n()})).catch((function(){return n&&n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x=function(){var e=Object(l.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j.a.get("https://canteen.sjtu.edu.cn/CARD/Ajax/Place").then((function(e){200===e.status?t&&t(e.data):n&&n()})).catch((function(){return n&&n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)([]),i=Object(s.a)(c,2),f=i[0],m=i[1],d=Object(a.useState)(!1),v=Object(s.a)(d,2),E=v[0],j=v[1],k=Object(a.useState)(""),O=Object(s.a)(k,2),S=O[0],C=O[1],A=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e){j(!0),C(e)},x((function(e){return o(e)}),(function(){t("\ud83d\ude25 \u83b7\u53d6\u98df\u5802\u6570\u636e\u5931\u8d25")})),y((function(e){return m(e)}),(function(){t("\ud83d\ude2b \u83b7\u53d6\u56fe\u4e66\u9986\u6570\u636e\u5931\u8d25")}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){A()}),[S]),Object(a.useEffect)((function(){var e=setInterval((function(){return A()}),2e4);return function(){return clearInterval(e)}}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,null,r.a.createElement(h.a,{container:!0,justify:"center"},r.a.createElement(p,{title:"\ud83d\udcd6",data:f.map((function(e){return{name:e.areaName,rest:e.max-e.inCounter,max:e.max}}))}),r.a.createElement(p,{title:"\ud83c\udf74",data:n.map((function(e){return{name:e.Name,rest:e.Seat_s-e.Seat_u,max:e.Seat_s}}))})),r.a.createElement(b.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:E,autoHideDuration:2e3,onClose:function(){return j(!1),void C("")}},r.a.createElement(w.a,{severity:"error"},S))))};var O=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(k,null))},S=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function C(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!==n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(O,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/libsjtu",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/libsjtu","/service-worker.js");S?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!==a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):C(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):C(t,e)}))}}()}},[[51,1,2]]]);
//# sourceMappingURL=main.cb2c68aa.chunk.js.map